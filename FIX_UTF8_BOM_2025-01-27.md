# Sửa Lỗi UTF-8 BOM - 2025-01-27

## Vấn Đề

Lỗi khi đọc file JSON có UTF-8 BOM (Byte Order Mark):
```
Unexpected UTF-8 BOM (decode using utf-8-sig): line 1 column 1 (char 0)
```

Lỗi này xảy ra khi đọc các file JSON có BOM ở đầu file, đặc biệt là:
- `storage.json` trong VSCode/Cursor
- File locale `vi.json`
- File backup JSON

## Giải Pháp

Thay đổi encoding từ `'utf-8'` sang `'utf-8-sig'` cho tất cả các thao tác đọc JSON.

### Files Đã Sửa

1. **core/vscode_handler.py** (3 vị trí)
   - Dòng 233: Đọc storage.json khi xử lý VSCode
   - Dòng 698: Đọc storage.json khi verify installation
   - Dòng 776: Đọc storage.json khi get current IDs

2. **gui_main.py** (3 vị trí)
   - Dòng 1546: Đọc storage.json trong view device ID details
   - Dòng 1953: Đọc storage.json trong view device ID details (variant khác)
   - Dòng 2534: Đọc storage.json khi clean workspace

3. **utils/i18n.py** (1 vị trí)
   - Dòng 42: Đọc file locale JSON

4. **utils/backup.py** (1 vị trí)
   - Dòng 408: Verify JSON backup file integrity

5. **locales/vi.json** (2 thông báo lỗi)
   - Cập nhật thông báo lỗi tiếng Việt để rõ ràng hơn

## Kết Quả

✅ Tất cả các file JSON có BOM giờ đây có thể đọc được bình thường
✅ Thông báo lỗi tiếng Việt được cải thiện
✅ Không ảnh hưởng đến hiệu năng
✅ Không có thay đổi về bảo mật

## Kiểm Tra

- ✅ Syntax check: Passed
- ✅ Linter: No errors
- ✅ Code review: No critical issues

## Ghi Chú

- File ghi JSON vẫn sử dụng `'utf-8'` (không ghi BOM) - đây là đúng
- Chỉ file đọc JSON mới cần `'utf-8-sig'` để xử lý BOM tự động

